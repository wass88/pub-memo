<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0" class="jsx-41c22be01142c0ef"/><meta name="format-detection" content="telephone=no,address=no,email=no" class="jsx-41c22be01142c0ef"/><meta http-equiv="X-UA-Compatible" content="IE=edge" class="jsx-41c22be01142c0ef"/><title>Vueっぽいものを実装してComputedの仕組みを探る - wassのメモ書き</title><meta name="description" content="Vueっぽいものを実装してComputedの仕組みを探る -- VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説しました。"/><link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;✍&lt;/text&gt;&lt;/svg&gt;"/><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/dc8f78c59f7140f9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dc8f78c59f7140f9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-142e59777b5c82a1.js" defer=""></script><script src="/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/_next/static/chunks/main-abbcac3391c38bd4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-809f5962319df396.js" defer=""></script><script src="/_next/static/chunks/175675d1-f160d4a5df49f5d3.js" defer=""></script><script src="/_next/static/chunks/3607272e-64ab698a8afc6376.js" defer=""></script><script src="/_next/static/chunks/823-40883892a14ca955.js" defer=""></script><script src="/_next/static/chunks/625-c751884491ded5a0.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bid%5D-972fa1a2ee456ca9.js" defer=""></script><script src="/_next/static/nq8v7rD2CePEjF_itLjZ-/_buildManifest.js" defer=""></script><script src="/_next/static/nq8v7rD2CePEjF_itLjZ-/_ssgManifest.js" defer=""></script><style id="__jsx-3bd76abe47806f9">a.jsx-3bd76abe47806f9{color:var(--main-fg-color);text-shadow:1px 1px var(--main-color)}a.jsx-3bd76abe47806f9:hover{text-shadow:1px 1px var(--main-color),-1px -1px var(--main-color)}</style><style id="__jsx-ac4cd3c041d76067">.tags.jsx-ac4cd3c041d76067{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row wrap;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;gap:8px;position:absolute;bottom:16px}.chip.jsx-ac4cd3c041d76067{padding:2px 16px;font-weight:bold;-webkit-border-radius:24px;-moz-border-radius:24px;border-radius:24px;color:var(--fg-color);background:var(--sub-dark-color)}.chip.jsx-ac4cd3c041d76067:hover{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1)}</style><style id="__jsx-a8d25eceb6600d98">.card.jsx-a8d25eceb6600d98{background:var(--fg-color);width:-webkit-calc((960px - 16px)/2);width:-moz-calc((960px - 16px)/2);width:calc((960px - 16px)/2);height:100%;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;color:var(--sub-darker-color);cursor:pointer;padding:0 12px 12px 12px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-flow:column;flex-flow:column;position:relative}.card.jsx-a8d25eceb6600d98 h2.jsx-a8d25eceb6600d98{margin:0 -12px 0 -12px;line-height:1.25;background:var(--sub-dark-color);padding:16px;-webkit-border-radius:12px 12px 0 0;-moz-border-radius:12px 12px 0 0;border-radius:12px 12px 0 0;color:var(--fg-color);font-weight:bold;text-shadow:1px 1px var(--sub-dark-color)}.card.jsx-a8d25eceb6600d98:hover{-webkit-transform:translate(2px,2px);-moz-transform:translate(2px,2px);-ms-transform:translate(2px,2px);-o-transform:translate(2px,2px);transform:translate(2px,2px)}p.jsx-a8d25eceb6600d98{margin:12px 0 12px 0;opacity:80%;padding-bottom:36px}@media screen and (max-width:960px){.card.jsx-a8d25eceb6600d98{width:initial}}</style><style id="__jsx-3dbb0f5aa2cfedf0">.column.jsx-3dbb0f5aa2cfedf0{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row wrap;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;gap:16px}@media screen and (max-width:960px){.column.jsx-3dbb0f5aa2cfedf0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-flow:column;flex-flow:column}}</style><style id="__jsx-2421c33cd1acb0d2">aside.jsx-2421c33cd1acb0d2{margin-top:3rem}.sub-info.jsx-2421c33cd1acb0d2{margin:-36px 0 16px 0;font-size:75%}nav.jsx-2421c33cd1acb0d2{margin-top:32px}</style><style id="__jsx-41c22be01142c0ef">*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0}:root{--main-color:#6eb488;--sub-light-color:#7ff0aa;--sub-darker-color:#3a6746;--sub-dark-color:#6eb488;--sub-lighter-color:#e8f4d9;--fg-color:var(--sub-lighter-color);--jump:16px}html{font-family:"Helvetica Neue",Arial,"Hiragino Kaku Gothic Pro","Yu Gothic Medium",YuGothic,"メイリオ",sans-serif;font-size:var(--jump);line-height:2;color:var(--fg-color);background:#151515}body{height:100vh}h1{font-size:400%;line-height:1.25;font-weight:bold;padding:-webkit-calc(3*var(--jump))0;padding:-moz-calc(3*var(--jump))0;padding:calc(3*var(--jump))0;--stripe-color:var(--sub-light-color);background-color:var(--main-color);background-image:-webkit-linear-gradient(left,transparent 50%,var(--stripe-color)50%);background-image:-moz-linear-gradient(left,transparent 50%,var(--stripe-color)50%);background-image:-o-linear-gradient(left,transparent 50%,var(--stripe-color)50%);background-image:linear-gradient(90deg,transparent 50%,var(--stripe-color)50%);-webkit-background-size:5px 10px;-moz-background-size:5px 10px;-o-background-size:5px 10px;background-size:5px 10px;-webkit-background-clip:text;background-clip:text;color:transparent;margin-top:-8px;margin-bottom:-36px}h2{font-size:150;text-shadow:1px 1px var(--sub-dark-color)}h3{font-size:100}.inner{max-width:960px;margin:0 auto}p{-webkit-margin-after:1rem;margin-block-end:1rem}@media screen and (max-width:960px){.inner{padding:0 16px}h1{font-size:200%}}a{text-decoration:inherit;color:inherit}a:hover{color:inherit}a:visited{color:inherit}ul{-webkit-padding-start:1rem;-moz-padding-start:1rem;padding-inline-start:1rem;-webkit-margin-after:1rem;margin-block-end:1rem}ul>ul{-webkit-margin-after:0;margin-block-end:0}</style></head><body><div id="__next" data-reactroot=""><div class="jsx-41c22be01142c0ef container"><div class="jsx-41c22be01142c0ef inner"><main class="jsx-41c22be01142c0ef"><a class="jsx-2421c33cd1acb0d2" href="/2022-10-28-vue-computed/"><h1 class="jsx-2421c33cd1acb0d2">Vueっぽいものを実装してComputedの仕組みを探る</h1></a><div class="jsx-2421c33cd1acb0d2 sub-info"><span class="jsx-2421c33cd1acb0d2">作成日: <!-- -->2022-10-28</span></div><main class="notion dark-mode notion-page notion-block-5d9d1a5bf3ba4562a71d126d16803f1c"><div class="notion-viewport"></div><h2 class="notion-h notion-h1 notion-default notion-h-indent-0 notion-block-5b520746be3248aa804ed5a59b1b2755" data-id="5b520746be3248aa804ed5a59b1b2755"><span><div id="5b520746be3248aa804ed5a59b1b2755" class="notion-header-anchor"></div><a class="notion-hash-link" href="#5b520746be3248aa804ed5a59b1b2755" title="まとめ"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">まとめ</span></span></h2><div class="notion-text notion-default notion-block-b3d3d41637644ac485dddbc3f0a1da1d">VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説します。仕組みは素朴ですが、実装から効率良い更新方法が自動で求まる良い仕組みです。</div><h2 class="notion-h notion-h1 notion-default notion-h-indent-0 notion-block-b9e85eef27f940d49f682de5f4d986fc" data-id="b9e85eef27f940d49f682de5f4d986fc"><span><div id="b9e85eef27f940d49f682de5f4d986fc" class="notion-header-anchor"></div><a class="notion-hash-link" href="#b9e85eef27f940d49f682de5f4d986fc" title="Vueとは"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Vueとは</span></span></h2><div class="notion-text notion-default notion-block-5aa25a1d9c7c4af69e7e22c3632d38f8">JSのフロントエンドライブラリの一つです。Reactに押されてやや落ち目です。</div><div class="notion-text notion-default notion-block-a864ff187c7e43628779f3560a0073bb">動的に変更されるModelを定義し、TemplateがModelを解釈して仮想DOMを構築する仕組みのライブラリです。</div><h3 class="notion-h notion-h2 notion-default notion-h-indent-1 notion-block-01488c6da5db4b029c4528addd88cf18" data-id="01488c6da5db4b029c4528addd88cf18"><span><div id="01488c6da5db4b029c4528addd88cf18" class="notion-header-anchor"></div><a class="notion-hash-link" href="#01488c6da5db4b029c4528addd88cf18" title="Computedとは"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Computedとは</span></span></h3><div class="notion-text notion-default notion-block-5ee84e3902e74245b0b0d05e0b3f2bbb">Computedは、ModelをTemplateをから扱いやすくするために、間に挟まる構造です。</div><div class="notion-text notion-default notion-block-c56ee1a95efc4856a7e123b531ae53d6">データから自動的にComputedが計算されて、Templateに使用できます。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token literal-property" style="color:#6cb8e6">computed</span><span class="token" style="color:#e9ae7e">:</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">name</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation" style="color:#e9ae7e">this</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">firtName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string" style="color:#91d076"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation" style="color:#e9ae7e">this</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">lastName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span></code></pre><div class="notion-text notion-default notion-block-71602a5cd26a4c61a476236298c8eeb3">上の例では、Computedの <code class="notion-inline-code">name</code> は、Modelの <code class="notion-inline-code">firstName</code>と<code class="notion-inline-code">lastName</code>から自動で計算されます。</div><h3 class="notion-h notion-h2 notion-default notion-h-indent-1 notion-block-0b31ba17acff44e88111a5f7d5c2a1b7" data-id="0b31ba17acff44e88111a5f7d5c2a1b7"><span><div id="0b31ba17acff44e88111a5f7d5c2a1b7" class="notion-header-anchor"></div><a class="notion-hash-link" href="#0b31ba17acff44e88111a5f7d5c2a1b7" title="Computedの部分的な再計算"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Computedの部分的な再計算</span></span></h3><div class="notion-text notion-default notion-block-8a60214eb4414a2196647ed63756434b">Modelが変更されると、Computedも変更されたModelの値を使って再計算されます。</div><div class="notion-text notion-default notion-block-244a438ff4fe43acb7e1513caefed337">Vueは再計算のとき、全てのComputedが再計算されるわけではなく、変更されたModelの値に影響のあるComputedだけが、再計算されます。</div><div class="notion-text notion-default notion-block-53f22f97978b4199b51eab09ff4a793c">部分的な再計算によって仮想DOMも更新されるので、全体としての効率が良くなります。</div><div class="notion-text notion-default notion-block-c1e0b29edf7146568da1f8d02cfa951d">ところで、この部分的な再計算はどのように実装されているのでしょう。</div><div class="notion-text notion-default notion-block-8e1ea67c7eb64bc788aa48e1a27d9d5a">Computedの実装では単にModelの値を直接使っているだけです。どのようにして、再計算が必要なComputedを見つけるのでしょうか。</div><h2 class="notion-h notion-h1 notion-default notion-h-indent-0 notion-block-223b3d5ebab54f3ea2066f166cdc8c14" data-id="223b3d5ebab54f3ea2066f166cdc8c14"><span><div id="223b3d5ebab54f3ea2066f166cdc8c14" class="notion-header-anchor"></div><a class="notion-hash-link" href="#223b3d5ebab54f3ea2066f166cdc8c14" title="Computedを実装してみる"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">Computedを実装してみる</span></span></h2><div class="notion-text notion-default notion-block-4c21c6321b5d423186febf9b4c51da31">Computedを実装したのがこちらの例です。ボタンを押すとテキストが変化します。</div><figure class="notion-asset-wrapper notion-asset-wrapper-embed notion-block-527ae971d5ee4410b5f0a7654a90a588"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:30vh"><iframe class="notion-asset-object-fit" src="https://jsfiddle.net/wass80/9f4u71ct/18/" title="iframe embed" frameBorder="0" allowfullscreen="" loading="lazy" scrolling="auto"></iframe></div></figure><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e9ae7e">const</span><span> data </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>	</span><span class="token literal-property" style="color:#6cb8e6">firstName</span><span class="token" style="color:#e9ae7e">:</span><span> </span><span class="token" style="color:#91d076">&quot;Super&quot;</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#6cb8e6">lastName</span><span class="token" style="color:#e9ae7e">:</span><span> </span><span class="token" style="color:#91d076">&quot;Alice&quot;</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span>  </span><span class="token literal-property" style="color:#6cb8e6">age</span><span class="token" style="color:#e9ae7e">:</span><span> </span><span class="token" style="color:#e6d37a">10</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e9ae7e">const</span><span> computed </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">name</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    </span><span class="token" style="color:#c699e3">log</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#91d076">&quot;computed name&quot;</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#8da1b9">// Modelを使ってComputedを定義</span><span>
</span><span>  	</span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation">self</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">data</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">firstName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string" style="color:#91d076"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation">self</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">data</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">lastName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span>	</span><span class="token" style="color:#c699e3">hello</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    </span><span class="token" style="color:#c699e3">log</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#91d076">&quot;computed hello&quot;</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span class="token template-string" style="color:#91d076">Hello, </span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation">self</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">computed</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">name</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string" style="color:#91d076"> (</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">${</span><span class="token template-string interpolation">self</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">data</span><span class="token template-string interpolation" style="color:#e3eaf2">.</span><span class="token template-string interpolation" style="color:#6cb8e6">age</span><span class="token template-string interpolation interpolation-punctuation" style="color:#e3eaf2">}</span><span class="token template-string" style="color:#91d076">)</span><span class="token template-string template-punctuation" style="color:#91d076">`</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">;</span></code></pre><div class="notion-text notion-default notion-block-f5529b42c2df4044a04797b8a4539e22">ボタンを押すと、メソッドが呼ばれて、dataが更新されます。名前を書き換えるLouderではlastName→name→helloと更新されます。歳を増やすgrowでは、age→helloと更新されます。無関係なcomputedは再計算されていないことに注目しましょう。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e9ae7e">const</span><span> method </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>	</span><span class="token" style="color:#c699e3">louder</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token" style="color:#c699e3">log</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#91d076">&quot;\nmethod louder:&quot;</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#8da1b9">// Modelを変更する</span><span>
</span><span>    self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">data</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">lastName</span><span> </span><span class="token" style="color:#e9ae7e">+=</span><span> </span><span class="token" style="color:#91d076">&quot;!&quot;</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">grow</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token" style="color:#c699e3">log</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#91d076">&quot;\nmethod grow:&quot;</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">data</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">age</span><span class="token" style="color:#e9ae7e">++</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span></code></pre><div class="notion-text notion-default notion-block-e6a5c80b9b3e44b898a254d42001c08a">Computeクラスがdataとcomputedとmethodを処理することで、Computedを実現しています。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token dom" style="color:#6cb8e6">window</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">compute</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e9ae7e">new</span><span> </span><span class="token" style="color:#6cb8e6">Compute</span><span class="token" style="color:#e3eaf2">(</span><span>data</span><span class="token" style="color:#e3eaf2">,</span><span> computed</span><span class="token" style="color:#e3eaf2">,</span><span> method</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span></code></pre><div class="notion-text notion-default notion-block-08bd8e7d934d4070966be9b786735f79">Computeクラスでは次の2つのトリックが使われています。</div><ul class="notion-list notion-list-disc notion-block-7055f61200f44782b1cf5b8cafec9603"><li>依存グラフの自動生成</li></ul><ul class="notion-list notion-list-disc notion-block-1f6027e1c95a4be0bc515c5ce1b37fa4"><li>ProxyObject</li></ul><h4 class="notion-h notion-h3 notion-default notion-h-indent-1 notion-block-f008ece2aef84a40a5106fc15e856cca" data-id="f008ece2aef84a40a5106fc15e856cca"><span><div id="f008ece2aef84a40a5106fc15e856cca" class="notion-header-anchor"></div><a class="notion-hash-link" href="#f008ece2aef84a40a5106fc15e856cca" title="依存グラフの自動生成"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">依存グラフの自動生成</span></span></h4><div class="notion-text notion-default notion-block-5b04efa541024a2eb6923f831897422f">先程の例で、「lastName→name→hello」や、「age→hello」といった更新順を表すグラフがありました。値の依存関係によって更新順を決めたグラフです。この依存グラフを自動生成できれば、Computedは実現できそうです。</div><div class="notion-text notion-default notion-block-4266104576784cd1a8e0a0078e465e5a">依存グラフの生成は、helloが呼ばれたときに行われています。値の中で他の値が使われるときに、使われる様子を追跡して、依存グラフを構築します</div><div class="notion-text notion-default notion-block-f1bbf6c12f664ad7baa23ec601d97275"><code class="notion-inline-code">this.deps</code> が依存元を表します。 <code class="notion-inline-code">self.currentDeps</code> が呼び出し元のリストです。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e9ae7e">class</span><span> </span><span class="token" style="color:#6cb8e6">DataValue</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">get</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#e9ae7e">if</span><span> </span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">length</span><span> </span><span class="token" style="color:#e9ae7e">&gt;</span><span> </span><span class="token" style="color:#e6d37a">0</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>      </span><span class="token" style="color:#8da1b9">// 最後の呼び出し元を依存先として追加する。</span><span>
</span><span>    	</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">deps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">add</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">slice</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e9ae7e">-</span><span class="token" style="color:#e6d37a">1</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">[</span><span class="token" style="color:#e6d37a">0</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span>  	</span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">value</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e9ae7e">class</span><span> </span><span class="token" style="color:#6cb8e6">ComputedValue</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">get</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token control-flow" style="color:#e9ae7e">if</span><span> </span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">length</span><span> </span><span class="token" style="color:#e9ae7e">&gt;</span><span> </span><span class="token" style="color:#e6d37a">0</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    	</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">deps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">add</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">slice</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e9ae7e">-</span><span class="token" style="color:#e6d37a">1</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">[</span><span class="token" style="color:#e6d37a">0</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span>    self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">push</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  	</span><span class="token control-flow" style="color:#e9ae7e">if</span><span> </span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">cache</span><span> </span><span class="token" style="color:#e9ae7e">===</span><span> </span><span class="token nil" style="color:#e9ae7e">undefined</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    	</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">cache</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">computed</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span>    self</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">currentDeps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">pop</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e3eaf2">)</span><span>
</span><span>    </span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">cache</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span></code></pre><div class="notion-text notion-default notion-block-590b8d0ed5eb403ab88551e3b2f2a567">値が更新されるたびに、作られた依存グラフに従ってComputedを再計算します。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e9ae7e">class</span><span> </span><span class="token" style="color:#6cb8e6">DataValue</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">set</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">,</span><span> value</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">value</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> value</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#8da1b9">// モデルが更新されたときに、</span><span>
</span><span>    </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">update</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">update</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>    </span><span class="token" style="color:#8da1b9">// 依存元を再計算する。</span><span>
</span><span>    </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">deps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">forEach</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">dep</span><span class="token arrow" style="color:#e9ae7e">=&gt;</span><span>dep</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">update</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e9ae7e">class</span><span> </span><span class="token" style="color:#6cb8e6">ComputedValue</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">update</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">self</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">cache</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">computed</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">deps</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">forEach</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">dep</span><span class="token arrow" style="color:#e9ae7e">=&gt;</span><span>dep</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">update</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span></code></pre><div class="notion-text notion-default notion-block-b2e77aa2021141e9b286bba4a14d6685">では、単なる関数の、どこに依存グラフを作るトリックが仕込まれているのでしょうか。</div><h4 class="notion-h notion-h3 notion-default notion-h-indent-1 notion-block-4d5f1e7417944be48fae7c48efef58b8" data-id="4d5f1e7417944be48fae7c48efef58b8"><span><div id="4d5f1e7417944be48fae7c48efef58b8" class="notion-header-anchor"></div><a class="notion-hash-link" href="#4d5f1e7417944be48fae7c48efef58b8" title="ProxyObject"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title">ProxyObject</span></span></h4><div class="notion-text notion-default notion-block-02d40729a9e6411d886bcd18d54ce4f3">JavaScriptにはProxyObjectという機能があります。Objectとして振る舞う値が、プロパティーの読み書きをフックして良からぬことをするためのAPIです。</div><div class="notion-text notion-default notion-block-842b75c8df1849c1a166f5eafbed4fc1">ProxyObjectによって、self.dataやself.computedはただのObjectではなくなっています。プロパティーが使われるたびに、プロパティーが誰によって使われたかを記録することで、依存グラフを構築します。のちに、this.dataのプロパティーが書き換えられると、ProxyObjectがComputedを最計算します。</div><pre style="color:#e3eaf2;background:#111b27;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto"><code class="language-javascript" style="color:#e3eaf2;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">row_data</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token known-class-name" style="color:#6cb8e6">Object</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">entries</span><span class="token" style="color:#e3eaf2">(</span><span>data</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">reduce</span><span class="token" style="color:#e3eaf2">(</span><span>
</span><span>	</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#6cb8e6">o</span><span class="token" style="color:#e3eaf2">,</span><span class="token" style="color:#6cb8e6"> </span><span class="token" style="color:#e3eaf2">[</span><span class="token" style="color:#6cb8e6">k</span><span class="token" style="color:#e3eaf2">,</span><span class="token" style="color:#6cb8e6"> v</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token arrow" style="color:#e9ae7e">=&gt;</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span class="token" style="color:#e3eaf2">[</span><span>k</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e9ae7e">:</span><span> </span><span class="token" style="color:#e9ae7e">new</span><span> </span><span class="token" style="color:#6cb8e6">DataValue</span><span class="token" style="color:#e3eaf2">(</span><span>v</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">,</span><span> </span><span class="token spread" style="color:#e9ae7e">...</span><span>o</span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span></span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">data</span><span> </span><span class="token" style="color:#e9ae7e">=</span><span> </span><span class="token" style="color:#e9ae7e">new</span><span> </span><span class="token" style="color:#6cb8e6">Proxy</span><span class="token" style="color:#e3eaf2">(</span><span class="token" style="color:#e9ae7e">this</span><span class="token" style="color:#e3eaf2">.</span><span class="token" style="color:#6cb8e6">row_data</span><span class="token" style="color:#e3eaf2">,</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>	</span><span class="token" style="color:#c699e3">get</span><span class="token" style="color:#e3eaf2">(</span><span>t</span><span class="token" style="color:#e3eaf2">,</span><span> prop</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	</span><span class="token control-flow" style="color:#e9ae7e">return</span><span> t</span><span class="token" style="color:#e3eaf2">[</span><span>prop</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">get</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">,</span><span>
</span><span>  </span><span class="token" style="color:#c699e3">set</span><span class="token" style="color:#e3eaf2">(</span><span>t</span><span class="token" style="color:#e3eaf2">,</span><span> prop</span><span class="token" style="color:#e3eaf2">,</span><span> value</span><span class="token" style="color:#e3eaf2">)</span><span> </span><span class="token" style="color:#e3eaf2">{</span><span>
</span><span>  	t</span><span class="token" style="color:#e3eaf2">[</span><span>prop</span><span class="token" style="color:#e3eaf2">]</span><span class="token" style="color:#e3eaf2">.</span><span class="token method" style="color:#6cb8e6">set</span><span class="token" style="color:#e3eaf2">(</span><span>self</span><span class="token" style="color:#e3eaf2">,</span><span> value</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>    </span><span class="token control-flow" style="color:#e9ae7e">return</span><span> </span><span class="token" style="color:#e6d37a">true</span><span class="token" style="color:#e3eaf2">;</span><span>
</span><span>  </span><span class="token" style="color:#e3eaf2">}</span><span>
</span><span></span><span class="token" style="color:#e3eaf2">}</span><span class="token" style="color:#e3eaf2">)</span><span class="token" style="color:#e3eaf2">;</span></code></pre><div class="notion-text notion-default notion-block-ae26db4818574e2f8e615f4b6307ff54">ProxyObjectを使うことで、Modelを普通のObjectのように振る舞えるようになりました。素直にComputedを実装するだけで、依存グラフが得られる面白い仕掛けだと思います。</div><div class="notion-blank notion-block-56428bc9d8594b12a499b10bce04fecb"> </div></main><aside class="jsx-2421c33cd1acb0d2"><p class="jsx-2421c33cd1acb0d2"><a href="https://twitter.com/intent/tweet?text=Vue%E3%81%A3%E3%81%BD%E3%81%84%E3%82%82%E3%81%AE%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%97%E3%81%A6Computed%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF%E3%82%92%E6%8E%A2%E3%82%8B%0Ahttps%3A%2F%2Fmemo.wass80.xyz%2F2022-10-28-vue-computed" target="_blank" rel="noopener noreferrer" class="jsx-3bd76abe47806f9">Twitterで共有する</a></p><a class="jsx-2421c33cd1acb0d2" href="/"><h1 class="jsx-2421c33cd1acb0d2">最新の記事</h1></a><div class="jsx-3dbb0f5aa2cfedf0 column"><a href="/2022-10-28-vue-computed/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">Vueっぽいものを実装してComputedの仕組みを探る</h2><p class="jsx-a8d25eceb6600d98">VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説しました。</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/vue/"><div class="jsx-ac4cd3c041d76067 chip">vue</div></a></object><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/js/"><div class="jsx-ac4cd3c041d76067 chip">js</div></a></object></div></div></a><a href="/2022-10-25-rust-c-compiler/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">Rustで「低レイヤを知りたい人のためのCコンパイラ作成入門」を少しやる</h2><p class="jsx-a8d25eceb6600d98">コンパイラ作りを思い出す</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/rust/"><div class="jsx-ac4cd3c041d76067 chip">rust</div></a></object><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/compiler/"><div class="jsx-ac4cd3c041d76067 chip">compiler</div></a></object></div></div></a><a href="/2022-10-05-tictactoe-random/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">三目並べをランダムに指したときの先手の勝利確率は?</h2><p class="jsx-a8d25eceb6600d98">まったくもってランダムに三目並べを行う</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/game/"><div class="jsx-ac4cd3c041d76067 chip">game</div></a></object></div></div></a><a href="/2022-08-09-infinite-turtle-brainfuck/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">コンベアで計算する『Infinite Turtle』でBrainfuckインタプリタを実装した</h2><p class="jsx-a8d25eceb6600d98">ベルトコンベアでbrainfuckを計算する様子</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/game/"><div class="jsx-ac4cd3c041d76067 chip">game</div></a></object></div></div></a><a href="/2022-08-08-inifinite-turtles/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">自動化コンベアでチューリング完全を目指す『Infinite Turtles』の紹介</h2><p class="jsx-a8d25eceb6600d98">steamのゲームの紹介。ベルトコンベアでいろんな問題を解く。</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/game/"><div class="jsx-ac4cd3c041d76067 chip">game</div></a></object></div></div></a><a href="/2022-08-07-ray-tracing-in-one-weekend/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">『Ray Tracing in One Weekend』をやった</h2><p class="jsx-a8d25eceb6600d98">レイトレーシングを実装する</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/rust/"><div class="jsx-ac4cd3c041d76067 chip">rust</div></a></object></div></div></a><a href="/2022-07-24-isucon12-qualified/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">ISUCON12予選突破した。 :old_noto_innocent: </h2><p class="jsx-a8d25eceb6600d98">ISUCON12予選突破できた。そのまとめ。</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/isucon/"><div class="jsx-ac4cd3c041d76067 chip">isucon</div></a></object><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/web/"><div class="jsx-ac4cd3c041d76067 chip">web</div></a></object></div></div></a><a href="/2022-07-13-notion-blog/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">Notionでもブログを書けるように</h2><p class="jsx-a8d25eceb6600d98">Notionからnextjsでブログを生成する</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/notion/"><div class="jsx-ac4cd3c041d76067 chip">notion</div></a></object><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/nextjs/"><div class="jsx-ac4cd3c041d76067 chip">nextjs</div></a></object></div></div></a><a href="/2021-10-29-next-js/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">メモ構築にnextjsを使う</h2><p class="jsx-a8d25eceb6600d98">nextjsのSSGで静的ブログを書く。Markdownではなく、生のReactでブログを書きたい。</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/js/"><div class="jsx-ac4cd3c041d76067 chip">js</div></a></object><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/nextjs/"><div class="jsx-ac4cd3c041d76067 chip">nextjs</div></a></object></div></div></a><a href="/2021-05-27-more-ultimate-ticktacktoe/"><div class="jsx-a8d25eceb6600d98 card"><h2 class="jsx-a8d25eceb6600d98">N次元マルバツゲーム Super Ultimate TickTackToe</h2><p class="jsx-a8d25eceb6600d98">異常にネストした◯✕ゲーム</p><div class="jsx-ac4cd3c041d76067 tags"><object class="jsx-ac4cd3c041d76067"><a class="jsx-ac4cd3c041d76067" href="/tags/game/"><div class="jsx-ac4cd3c041d76067 chip">game</div></a></object></div></div></a></div></aside></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2022-10-28-vue-computed","notion":[{"notionID":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","id":"2022-10-28-vue-computed","icon":null,"tags":["vue","js"],"title":"Vueっぽいものを実装してComputedの仕組みを探る","summary":"VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説しました。","recordMap":{"block":{"5d9d1a5b-f3ba-4562-a71d-126d16803f1c":{"type":"reader","value":{"id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","content":["5b520746-be32-48aa-804e-d5a59b1b2755","b3d3d416-3764-4ac4-85dd-dbc3f0a1da1d","b9e85eef-27f9-40d4-9f68-2de5f4d986fc","5aa25a1d-9c7c-4af6-9e7e-22c3632d38f8","a864ff18-7c7e-4362-8779-f3560a0073bb","01488c6d-a5db-4b02-9c45-28addd88cf18","5ee84e39-02e7-4245-b0b0-d05e0b3f2bbb","c56ee1a9-5efc-4856-a7e1-23b531ae53d6","94433a07-8ae5-40b7-a9b1-4112c63201a9","71602a5c-d26a-4c61-a476-236298c8eeb3","0b31ba17-acff-44e8-8111-a5f7d5c2a1b7","8a60214e-b441-4a21-9664-7ed63756434b","244a438f-f4fe-43ac-b7e1-513caefed337","53f22f97-978b-4199-b51e-ab09ff4a793c","c1e0b29e-df71-4656-8da1-f8d02cfa951d","8e1ea67c-7eb6-4bc7-88aa-48e1a27d9d5a","223b3d5e-bab5-4f3e-a206-6f166cdc8c14","4c21c632-1b5d-4231-86fe-bf9b4c51da31","527ae971-d5ee-4410-b5f0-a7654a90a588","6a558581-90eb-48d4-909e-b740d344b9f9","f5529b42-c2df-4044-a047-97b8a4539e22","4e98d2dd-954d-4b65-9061-97b22493a8c2","e6a5c80b-9b3e-44b8-98a2-54d42001c08a","55f20833-28dc-479b-88bb-d6177f0b29de","08bd8e7d-934d-4070-966b-e9b786735f79","7055f612-00f4-4782-b1cf-5b8cafec9603","1f6027e1-c95a-4be0-bc51-5c5ce1b37fa4","f008ece2-aef8-4a40-a510-6fc15e856cca","5b04efa5-4102-4a2e-b692-3f831897422f","42661045-7678-4cd1-a8e0-a0078e465e5a","f1bbf6c1-2f66-4ad7-baa2-3ec601d97275","71893f9a-b5c6-4f40-b852-524522f5866a","590b8d0e-d5eb-403a-b885-51e3b2f2a567","23316f3a-2d35-4197-a9e7-85aa8fffaf7a","b2e77aa2-0211-41e9-b286-bba4a14d6685","4d5f1e74-1794-4be4-8fae-7c48efef58b8","02d40729-a9e6-411d-886b-cd18d54ce4f3","842b75c8-df18-49c1-a166-f5eafbed4fc1","bbba96fa-7164-4515-867a-753517a4a0bf","ae26db48-1857-4e2f-8e61-5f4b6307ff54","56428bc9-d859-4b12-a499-b10bce04fecb"],"properties":{"title":[["Vueっぽいものを実装してComputedの仕組みを探る"]]},"format":{},"type":"page","created_time":1666837800000,"last_edited_time":1666909020000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"57afe6b6-f3fa-48bf-9a52-f29731547d0d","parent_table":"table"}},"57afe6b6-f3fa-48bf-9a52-f29731547d0d":{"type":"reader","value":{"id":"57afe6b6-f3fa-48bf-9a52-f29731547d0d","properties":{},"format":{},"type":"child_database","created_time":1656396780000,"last_edited_time":1666858500000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true}},"5b520746-be32-48aa-804e-d5a59b1b2755":{"type":"reader","value":{"id":"5b520746-be32-48aa-804e-d5a59b1b2755","properties":{"title":[["まとめ"]]},"format":{"block_color":"default"},"type":"header","created_time":1666860420000,"last_edited_time":1666860420000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"b3d3d416-3764-4ac4-85dd-dbc3f0a1da1d":{"type":"reader","value":{"id":"b3d3d416-3764-4ac4-85dd-dbc3f0a1da1d","properties":{"title":[["VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説します。仕組みは素朴ですが、実装から効率良い更新方法が自動で求まる良い仕組みです。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666860420000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"b9e85eef-27f9-40d4-9f68-2de5f4d986fc":{"type":"reader","value":{"id":"b9e85eef-27f9-40d4-9f68-2de5f4d986fc","properties":{"title":[["Vueとは"]]},"format":{"block_color":"default"},"type":"header","created_time":1666837860000,"last_edited_time":1666860420000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"5aa25a1d-9c7c-4af6-9e7e-22c3632d38f8":{"type":"reader","value":{"id":"5aa25a1d-9c7c-4af6-9e7e-22c3632d38f8","properties":{"title":[["JSのフロントエンドライブラリの一つです。Reactに押されてやや落ち目です。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666837920000,"last_edited_time":1666858500000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"a864ff18-7c7e-4362-8779-f3560a0073bb":{"type":"reader","value":{"id":"a864ff18-7c7e-4362-8779-f3560a0073bb","properties":{"title":[["動的に変更されるModelを定義し、TemplateがModelを解釈して仮想DOMを構築する仕組みのライブラリです。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666908660000,"last_edited_time":1666908660000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"01488c6d-a5db-4b02-9c45-28addd88cf18":{"type":"reader","value":{"id":"01488c6d-a5db-4b02-9c45-28addd88cf18","properties":{"title":[["Computedとは"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1666837860000,"last_edited_time":1666851180000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"5ee84e39-02e7-4245-b0b0-d05e0b3f2bbb":{"type":"reader","value":{"id":"5ee84e39-02e7-4245-b0b0-d05e0b3f2bbb","properties":{"title":[["Computedは、ModelをTemplateをから扱いやすくするために、間に挟まる構造です。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851120000,"last_edited_time":1666859280000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"c56ee1a9-5efc-4856-a7e1-23b531ae53d6":{"type":"reader","value":{"id":"c56ee1a9-5efc-4856-a7e1-23b531ae53d6","properties":{"title":[["データから自動的にComputedが計算されて、Templateに使用できます。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851180000,"last_edited_time":1666859160000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"94433a07-8ae5-40b7-a9b1-4112c63201a9":{"type":"reader","value":{"id":"94433a07-8ae5-40b7-a9b1-4112c63201a9","properties":{"title":[["computed: {\n  name() {\n    return `${this.firtName} ${this.lastName}`;\n  }\n}"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666851180000,"last_edited_time":1666851480000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"71602a5c-d26a-4c61-a476-236298c8eeb3":{"type":"reader","value":{"id":"71602a5c-d26a-4c61-a476-236298c8eeb3","properties":{"title":[["上の例では、Computedの "],["name",[["c"]]],[" は、Modelの "],["firstName",[["c"]]],["と"],["lastName",[["c"]]],["から自動で計算されます。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851180000,"last_edited_time":1666858560000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"0b31ba17-acff-44e8-8111-a5f7d5c2a1b7":{"type":"reader","value":{"id":"0b31ba17-acff-44e8-8111-a5f7d5c2a1b7","properties":{"title":[["Computedの部分的な再計算"]]},"format":{"block_color":"default"},"type":"sub_header","created_time":1666851360000,"last_edited_time":1666859280000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"8a60214e-b441-4a21-9664-7ed63756434b":{"type":"reader","value":{"id":"8a60214e-b441-4a21-9664-7ed63756434b","properties":{"title":[["Modelが変更されると、Computedも変更されたModelの値を使って再計算されます。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851360000,"last_edited_time":1666858620000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"244a438f-f4fe-43ac-b7e1-513caefed337":{"type":"reader","value":{"id":"244a438f-f4fe-43ac-b7e1-513caefed337","properties":{"title":[["Vueは再計算のとき、全てのComputedが再計算されるわけではなく、変更されたModelの値に影響のあるComputedだけが、再計算されます。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851420000,"last_edited_time":1666858620000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"53f22f97-978b-4199-b51e-ab09ff4a793c":{"type":"reader","value":{"id":"53f22f97-978b-4199-b51e-ab09ff4a793c","properties":{"title":[["部分的な再計算によって仮想DOMも更新されるので、全体としての効率が良くなります。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851480000,"last_edited_time":1666851540000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"c1e0b29e-df71-4656-8da1-f8d02cfa951d":{"type":"reader","value":{"id":"c1e0b29e-df71-4656-8da1-f8d02cfa951d","properties":{"title":[["ところで、この部分的な再計算はどのように実装されているのでしょう。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851540000,"last_edited_time":1666851600000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"8e1ea67c-7eb6-4bc7-88aa-48e1a27d9d5a":{"type":"reader","value":{"id":"8e1ea67c-7eb6-4bc7-88aa-48e1a27d9d5a","properties":{"title":[["Computedの実装では単にModelの値を直接使っているだけです。どのようにして、再計算が必要なComputedを見つけるのでしょうか。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666851540000,"last_edited_time":1666858620000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"223b3d5e-bab5-4f3e-a206-6f166cdc8c14":{"type":"reader","value":{"id":"223b3d5e-bab5-4f3e-a206-6f166cdc8c14","properties":{"title":[["Computedを実装してみる"]]},"format":{"block_color":"default"},"type":"header","created_time":1666837860000,"last_edited_time":1666851180000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"4c21c632-1b5d-4231-86fe-bf9b4c51da31":{"type":"reader","value":{"id":"4c21c632-1b5d-4231-86fe-bf9b4c51da31","properties":{"title":[["Computedを実装したのがこちらの例です。ボタンを押すとテキストが変化します。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666852800000,"last_edited_time":1666854120000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"527ae971-d5ee-4410-b5f0-a7654a90a588":{"type":"reader","value":{"id":"527ae971-d5ee-4410-b5f0-a7654a90a588","properties":{"source":[["https://jsfiddle.net/wass80/9f4u71ct/18/"]]},"format":{"block_page_width":true,"block_height":"30vh"},"type":"embed","created_time":1666852800000,"last_edited_time":1666858200000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"6a558581-90eb-48d4-909e-b740d344b9f9":{"type":"reader","value":{"id":"6a558581-90eb-48d4-909e-b740d344b9f9","properties":{"title":[["const data = {\n\tfirstName: \"Super\",\n  lastName: \"Alice\",\n  age: 10,\n}\nconst computed = {\n  name(self) {\n    log(\"computed name\");\n    // Modelを使ってComputedを定義\n  \treturn `${self.data.firstName} ${self.data.lastName}`;\n  },\n\thello(self) {\n    log(\"computed hello\");\n    return `Hello, ${self.computed.name} (${self.data.age})`\n  },\n};"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666852800000,"last_edited_time":1666908840000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"f5529b42-c2df-4044-a047-97b8a4539e22":{"type":"reader","value":{"id":"f5529b42-c2df-4044-a047-97b8a4539e22","properties":{"title":[["ボタンを押すと、メソッドが呼ばれて、dataが更新されます。名前を書き換えるLouderではlastName→name→helloと更新されます。歳を増やすgrowでは、age→helloと更新されます。無関係なcomputedは再計算されていないことに注目しましょう。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666852800000,"last_edited_time":1666859160000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"4e98d2dd-954d-4b65-9061-97b22493a8c2":{"type":"reader","value":{"id":"4e98d2dd-954d-4b65-9061-97b22493a8c2","properties":{"title":[["const method = {\n\tlouder(self) {\n  \tlog(\"\\nmethod louder:\");\n    // Modelを変更する\n    self.data.lastName += \"!\";\n  },\n  grow(self) {\n  \tlog(\"\\nmethod grow:\");\n    self.data.age++;\n  },\n}"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666852860000,"last_edited_time":1666908840000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"e6a5c80b-9b3e-44b8-98a2-54d42001c08a":{"type":"reader","value":{"id":"e6a5c80b-9b3e-44b8-98a2-54d42001c08a","properties":{"title":[["Computeクラスがdataとcomputedとmethodを処理することで、Computedを実現しています。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666852860000,"last_edited_time":1666852920000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"55f20833-28dc-479b-88bb-d6177f0b29de":{"type":"reader","value":{"id":"55f20833-28dc-479b-88bb-d6177f0b29de","properties":{"title":[["window.compute = new Compute(data, computed, method);"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666852860000,"last_edited_time":1666853040000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"08bd8e7d-934d-4070-966b-e9b786735f79":{"type":"reader","value":{"id":"08bd8e7d-934d-4070-966b-e9b786735f79","properties":{"title":[["Computeクラスでは次の2つのトリックが使われています。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666852860000,"last_edited_time":1666853700000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"7055f612-00f4-4782-b1cf-5b8cafec9603":{"type":"reader","value":{"id":"7055f612-00f4-4782-b1cf-5b8cafec9603","properties":{"title":[["依存グラフの自動生成"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1666853700000,"last_edited_time":1666853700000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"1f6027e1-c95a-4be0-bc51-5c5ce1b37fa4":{"type":"reader","value":{"id":"1f6027e1-c95a-4be0-bc51-5c5ce1b37fa4","properties":{"title":[["ProxyObject"]]},"format":{"block_color":"default"},"type":"bulleted_list","created_time":1666853700000,"last_edited_time":1666853760000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"f008ece2-aef8-4a40-a510-6fc15e856cca":{"type":"reader","value":{"id":"f008ece2-aef8-4a40-a510-6fc15e856cca","properties":{"title":[["依存グラフの自動生成"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1666853760000,"last_edited_time":1666853820000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"5b04efa5-4102-4a2e-b692-3f831897422f":{"type":"reader","value":{"id":"5b04efa5-4102-4a2e-b692-3f831897422f","properties":{"title":[["先程の例で、「lastName→name→hello」や、「age→hello」といった更新順を表すグラフがありました。値の依存関係によって更新順を決めたグラフです。この依存グラフを自動生成できれば、Computedは実現できそうです。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666853760000,"last_edited_time":1666853940000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"42661045-7678-4cd1-a8e0-a0078e465e5a":{"type":"reader","value":{"id":"42661045-7678-4cd1-a8e0-a0078e465e5a","properties":{"title":[["依存グラフの生成は、helloが呼ばれたときに行われています。値の中で他の値が使われるときに、使われる様子を追跡して、依存グラフを構築します"]]},"format":{"block_color":"default"},"type":"text","created_time":1666853940000,"last_edited_time":1666858920000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"f1bbf6c1-2f66-4ad7-baa2-3ec601d97275":{"type":"reader","value":{"id":"f1bbf6c1-2f66-4ad7-baa2-3ec601d97275","properties":{"title":[["this.deps",[["c"]]],[" が依存元を表します。 "],["self.currentDeps",[["c"]]],[" が呼び出し元のリストです。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666858920000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"71893f9a-b5c6-4f40-b852-524522f5866a":{"type":"reader","value":{"id":"71893f9a-b5c6-4f40-b852-524522f5866a","properties":{"title":[["class DataValue {\n  get(self) {\n    if (self.currentDeps.length \u003e 0) {\n      // 最後の呼び出し元を依存先として追加する。\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n  \treturn this.value;\n}\nclass ComputedValue {\n  get(self) {\n  \tif (self.currentDeps.length \u003e 0) {\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n    self.currentDeps.push(this);\n  \tif (this.cache === undefined) {\n    \tthis.cache = this.computed(self);\n    }\n    self.currentDeps.pop()\n    return this.cache;\n  }\n}"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666855500000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"590b8d0e-d5eb-403a-b885-51e3b2f2a567":{"type":"reader","value":{"id":"590b8d0e-d5eb-403a-b885-51e3b2f2a567","properties":{"title":[["値が更新されるたびに、作られた依存グラフに従ってComputedを再計算します。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666854000000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"23316f3a-2d35-4197-a9e7-85aa8fffaf7a":{"type":"reader","value":{"id":"23316f3a-2d35-4197-a9e7-85aa8fffaf7a","properties":{"title":[["class DataValue {\n  set(self, value){\n  \tthis.value = value;\n    // モデルが更新されたときに、\n    this.update(self);\n  }\n  update(self) {\n    // 依存元を再計算する。\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}\nclass ComputedValue {\n  update(self) {\n  \tthis.cache = this.computed(self);\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666858020000,"last_edited_time":1666908840000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"b2e77aa2-0211-41e9-b286-bba4a14d6685":{"type":"reader","value":{"id":"b2e77aa2-0211-41e9-b286-bba4a14d6685","properties":{"title":[["では、単なる関数の、どこに依存グラフを作るトリックが仕込まれているのでしょうか。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666854000000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"4d5f1e74-1794-4be4-8fae-7c48efef58b8":{"type":"reader","value":{"id":"4d5f1e74-1794-4be4-8fae-7c48efef58b8","properties":{"title":[["ProxyObject"]]},"format":{"block_color":"default"},"type":"sub_sub_header","created_time":1666853820000,"last_edited_time":1666853820000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"02d40729-a9e6-411d-886b-cd18d54ce4f3":{"type":"reader","value":{"id":"02d40729-a9e6-411d-886b-cd18d54ce4f3","properties":{"title":[["JavaScriptにはProxyObjectという機能があります。Objectとして振る舞う値が、プロパティーの読み書きをフックして良からぬことをするためのAPIです。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666853820000,"last_edited_time":1666860420000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"842b75c8-df18-49c1-a166-f5eafbed4fc1":{"type":"reader","value":{"id":"842b75c8-df18-49c1-a166-f5eafbed4fc1","properties":{"title":[["ProxyObjectによって、self.dataやself.computedはただのObjectではなくなっています。プロパティーが使われるたびに、プロパティーが誰によって使われたかを記録することで、依存グラフを構築します。のちに、this.dataのプロパティーが書き換えられると、ProxyObjectがComputedを最計算します。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666854000000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"bbba96fa-7164-4515-867a-753517a4a0bf":{"type":"reader","value":{"id":"bbba96fa-7164-4515-867a-753517a4a0bf","properties":{"title":[["this.row_data = Object.entries(data).reduce(\n\t(o, [k, v]) =\u003e {return {[k]: new DataValue(v), ...o}}, {});\nthis.data = new Proxy(this.row_data, {\n\tget(t, prop) {\n  \treturn t[prop].get(self);\n  },\n  set(t, prop, value) {\n  \tt[prop].set(self, value);\n    return true;\n  }\n});"]],"language":[["javascript"]]},"format":{},"type":"code","created_time":1666858080000,"last_edited_time":1666908900000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"ae26db48-1857-4e2f-8e61-5f4b6307ff54":{"type":"reader","value":{"id":"ae26db48-1857-4e2f-8e61-5f4b6307ff54","properties":{"title":[["ProxyObjectを使うことで、Modelを普通のObjectのように振る舞えるようになりました。素直にComputedを実装するだけで、依存グラフが得られる面白い仕掛けだと思います。"]]},"format":{"block_color":"default"},"type":"text","created_time":1666908900000,"last_edited_time":1666909020000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}},"56428bc9-d859-4b12-a499-b10bce04fecb":{"type":"reader","value":{"id":"56428bc9-d859-4b12-a499-b10bce04fecb","format":{"block_color":"default"},"type":"text","created_time":1666908960000,"last_edited_time":1666908960000,"created_by_table":"notion_user","created_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","last_edited_by_table":"user","last_edited_by_id":"7efc331f-9b9e-449d-862e-b0eebef23f04","alive":true,"parent_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent_table":"block"}}},"collection":{},"collection_view":{},"collection_query":{},"signed_urls":{},"notion_user":{},"raw":{"page":{"object":"page","id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","created_time":"2022-10-27T02:30:00.000Z","last_edited_time":"2022-10-27T22:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"cover":null,"icon":null,"parent":{"type":"database_id","database_id":"57afe6b6-f3fa-48bf-9a52-f29731547d0d"},"archived":false,"properties":{"ID":{"id":"cRSs","type":"rich_text","rich_text":[{"type":"text","text":{"content":"vue-computed","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"vue-computed","href":null}]},"Summary":{"id":"e%3BSi","type":"rich_text","rich_text":[{"type":"text","text":{"content":"VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説しました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説しました。","href":null}]},"Created":{"id":"nlFt","type":"created_time","created_time":"2022-10-27T02:30:00.000Z"},"Tags":{"id":"pJSo","type":"multi_select","multi_select":[{"id":"1601a69f-90a1-4cf3-8acd-8303e40a4191","name":"vue","color":"red"},{"id":"94a95c89-9388-432d-933a-742046b697ea","name":"js","color":"yellow"}]},"PublishedAt":{"id":"wN%3Dw","type":"date","date":{"start":"2022-10-28","end":null,"time_zone":null}},"Name":{"id":"title","type":"title","title":[{"type":"text","text":{"content":"Vueっぽいものを実装してComputedの仕組みを探る","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Vueっぽいものを実装してComputedの仕組みを探る","href":null}]}},"url":"https://www.notion.so/Vue-Computed-5d9d1a5bf3ba4562a71d126d16803f1c"},"block":{"object":"block","id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c","parent":{"type":"database_id","database_id":"57afe6b6-f3fa-48bf-9a52-f29731547d0d"},"created_time":"2022-10-27T02:30:00.000Z","last_edited_time":"2022-10-27T22:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":true,"archived":false,"type":"child_page","child_page":{"title":"Vueっぽいものを実装してComputedの仕組みを探る"}},"children":[{"object":"block","id":"5b520746-be32-48aa-804e-d5a59b1b2755","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T08:47:00.000Z","last_edited_time":"2022-10-27T08:47:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"まとめ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"まとめ","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"b3d3d416-3764-4ac4-85dd-dbc3f0a1da1d","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T08:47:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説します。仕組みは素朴ですが、実装から効率良い更新方法が自動で求まる良い仕組みです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"VueのComputedのやや魔法っぽい、依存関係の自動導出についての仕組みを、簡単な実装で解説します。仕組みは素朴ですが、実装から効率良い更新方法が自動で求まる良い仕組みです。","href":null}],"color":"default"}},{"object":"block","id":"b9e85eef-27f9-40d4-9f68-2de5f4d986fc","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T02:31:00.000Z","last_edited_time":"2022-10-27T08:47:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"Vueとは","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Vueとは","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"5aa25a1d-9c7c-4af6-9e7e-22c3632d38f8","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T02:32:00.000Z","last_edited_time":"2022-10-27T08:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"JSのフロントエンドライブラリの一つです。Reactに押されてやや落ち目です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"JSのフロントエンドライブラリの一つです。Reactに押されてやや落ち目です。","href":null}],"color":"default"}},{"object":"block","id":"a864ff18-7c7e-4362-8779-f3560a0073bb","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T22:11:00.000Z","last_edited_time":"2022-10-27T22:11:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"動的に変更されるModelを定義し、TemplateがModelを解釈して仮想DOMを構築する仕組みのライブラリです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"動的に変更されるModelを定義し、TemplateがModelを解釈して仮想DOMを構築する仕組みのライブラリです。","href":null}],"color":"default"}},{"object":"block","id":"01488c6d-a5db-4b02-9c45-28addd88cf18","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T02:31:00.000Z","last_edited_time":"2022-10-27T06:13:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Computedとは","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedとは","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"5ee84e39-02e7-4245-b0b0-d05e0b3f2bbb","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:12:00.000Z","last_edited_time":"2022-10-27T08:28:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Computedは、ModelをTemplateをから扱いやすくするために、間に挟まる構造です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedは、ModelをTemplateをから扱いやすくするために、間に挟まる構造です。","href":null}],"color":"default"}},{"object":"block","id":"c56ee1a9-5efc-4856-a7e1-23b531ae53d6","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:13:00.000Z","last_edited_time":"2022-10-27T08:26:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"データから自動的にComputedが計算されて、Templateに使用できます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"データから自動的にComputedが計算されて、Templateに使用できます。","href":null}],"color":"default"}},{"object":"block","id":"94433a07-8ae5-40b7-a9b1-4112c63201a9","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:13:00.000Z","last_edited_time":"2022-10-27T06:18:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"computed: {\n  name() {\n    return `${this.firtName} ${this.lastName}`;\n  }\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"computed: {\n  name() {\n    return `${this.firtName} ${this.lastName}`;\n  }\n}","href":null}],"language":"javascript"}},{"object":"block","id":"71602a5c-d26a-4c61-a476-236298c8eeb3","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:13:00.000Z","last_edited_time":"2022-10-27T08:16:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"上の例では、Computedの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"上の例では、Computedの ","href":null},{"type":"text","text":{"content":"name","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"name","href":null},{"type":"text","text":{"content":" は、Modelの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は、Modelの ","href":null},{"type":"text","text":{"content":"firstName","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"firstName","href":null},{"type":"text","text":{"content":"と","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"と","href":null},{"type":"text","text":{"content":"lastName","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"lastName","href":null},{"type":"text","text":{"content":"から自動で計算されます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"から自動で計算されます。","href":null}],"color":"default"}},{"object":"block","id":"0b31ba17-acff-44e8-8111-a5f7d5c2a1b7","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:16:00.000Z","last_edited_time":"2022-10-27T08:28:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"Computedの部分的な再計算","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedの部分的な再計算","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"8a60214e-b441-4a21-9664-7ed63756434b","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:16:00.000Z","last_edited_time":"2022-10-27T08:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Modelが変更されると、Computedも変更されたModelの値を使って再計算されます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Modelが変更されると、Computedも変更されたModelの値を使って再計算されます。","href":null}],"color":"default"}},{"object":"block","id":"244a438f-f4fe-43ac-b7e1-513caefed337","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:17:00.000Z","last_edited_time":"2022-10-27T08:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Vueは再計算のとき、全てのComputedが再計算されるわけではなく、変更されたModelの値に影響のあるComputedだけが、再計算されます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Vueは再計算のとき、全てのComputedが再計算されるわけではなく、変更されたModelの値に影響のあるComputedだけが、再計算されます。","href":null}],"color":"default"}},{"object":"block","id":"53f22f97-978b-4199-b51e-ab09ff4a793c","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:18:00.000Z","last_edited_time":"2022-10-27T06:19:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"部分的な再計算によって仮想DOMも更新されるので、全体としての効率が良くなります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"部分的な再計算によって仮想DOMも更新されるので、全体としての効率が良くなります。","href":null}],"color":"default"}},{"object":"block","id":"c1e0b29e-df71-4656-8da1-f8d02cfa951d","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:19:00.000Z","last_edited_time":"2022-10-27T06:20:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ところで、この部分的な再計算はどのように実装されているのでしょう。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ところで、この部分的な再計算はどのように実装されているのでしょう。","href":null}],"color":"default"}},{"object":"block","id":"8e1ea67c-7eb6-4bc7-88aa-48e1a27d9d5a","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:19:00.000Z","last_edited_time":"2022-10-27T08:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Computedの実装では単にModelの値を直接使っているだけです。どのようにして、再計算が必要なComputedを見つけるのでしょうか。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedの実装では単にModelの値を直接使っているだけです。どのようにして、再計算が必要なComputedを見つけるのでしょうか。","href":null}],"color":"default"}},{"object":"block","id":"223b3d5e-bab5-4f3e-a206-6f166cdc8c14","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T02:31:00.000Z","last_edited_time":"2022-10-27T06:13:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"Computedを実装してみる","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedを実装してみる","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"4c21c632-1b5d-4231-86fe-bf9b4c51da31","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:40:00.000Z","last_edited_time":"2022-10-27T07:02:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Computedを実装したのがこちらの例です。ボタンを押すとテキストが変化します。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computedを実装したのがこちらの例です。ボタンを押すとテキストが変化します。","href":null}],"color":"default"}},{"object":"block","id":"527ae971-d5ee-4410-b5f0-a7654a90a588","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:40:00.000Z","last_edited_time":"2022-10-27T08:10:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"embed","embed":{"caption":[],"url":"https://jsfiddle.net/wass80/9f4u71ct/18/"}},{"object":"block","id":"6a558581-90eb-48d4-909e-b740d344b9f9","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:40:00.000Z","last_edited_time":"2022-10-27T22:14:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"const data = {\n\tfirstName: \"Super\",\n  lastName: \"Alice\",\n  age: 10,\n}\nconst computed = {\n  name(self) {\n    log(\"computed name\");\n    // Modelを使ってComputedを定義\n  \treturn `${self.data.firstName} ${self.data.lastName}`;\n  },\n\thello(self) {\n    log(\"computed hello\");\n    return `Hello, ${self.computed.name} (${self.data.age})`\n  },\n};","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"const data = {\n\tfirstName: \"Super\",\n  lastName: \"Alice\",\n  age: 10,\n}\nconst computed = {\n  name(self) {\n    log(\"computed name\");\n    // Modelを使ってComputedを定義\n  \treturn `${self.data.firstName} ${self.data.lastName}`;\n  },\n\thello(self) {\n    log(\"computed hello\");\n    return `Hello, ${self.computed.name} (${self.data.age})`\n  },\n};","href":null}],"language":"javascript"}},{"object":"block","id":"f5529b42-c2df-4044-a047-97b8a4539e22","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:40:00.000Z","last_edited_time":"2022-10-27T08:26:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ボタンを押すと、メソッドが呼ばれて、dataが更新されます。名前を書き換えるLouderではlastName→name→helloと更新されます。歳を増やすgrowでは、age→helloと更新されます。無関係なcomputedは再計算されていないことに注目しましょう。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ボタンを押すと、メソッドが呼ばれて、dataが更新されます。名前を書き換えるLouderではlastName→name→helloと更新されます。歳を増やすgrowでは、age→helloと更新されます。無関係なcomputedは再計算されていないことに注目しましょう。","href":null}],"color":"default"}},{"object":"block","id":"4e98d2dd-954d-4b65-9061-97b22493a8c2","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:41:00.000Z","last_edited_time":"2022-10-27T22:14:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"const method = {\n\tlouder(self) {\n  \tlog(\"\\nmethod louder:\");\n    // Modelを変更する\n    self.data.lastName += \"!\";\n  },\n  grow(self) {\n  \tlog(\"\\nmethod grow:\");\n    self.data.age++;\n  },\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"const method = {\n\tlouder(self) {\n  \tlog(\"\\nmethod louder:\");\n    // Modelを変更する\n    self.data.lastName += \"!\";\n  },\n  grow(self) {\n  \tlog(\"\\nmethod grow:\");\n    self.data.age++;\n  },\n}","href":null}],"language":"javascript"}},{"object":"block","id":"e6a5c80b-9b3e-44b8-98a2-54d42001c08a","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:41:00.000Z","last_edited_time":"2022-10-27T06:42:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Computeクラスがdataとcomputedとmethodを処理することで、Computedを実現しています。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computeクラスがdataとcomputedとmethodを処理することで、Computedを実現しています。","href":null}],"color":"default"}},{"object":"block","id":"55f20833-28dc-479b-88bb-d6177f0b29de","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:41:00.000Z","last_edited_time":"2022-10-27T06:44:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"window.compute = new Compute(data, computed, method);","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"window.compute = new Compute(data, computed, method);","href":null}],"language":"javascript"}},{"object":"block","id":"08bd8e7d-934d-4070-966b-e9b786735f79","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:41:00.000Z","last_edited_time":"2022-10-27T06:55:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Computeクラスでは次の2つのトリックが使われています。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Computeクラスでは次の2つのトリックが使われています。","href":null}],"color":"default"}},{"object":"block","id":"7055f612-00f4-4782-b1cf-5b8cafec9603","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:55:00.000Z","last_edited_time":"2022-10-27T06:55:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"依存グラフの自動生成","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"依存グラフの自動生成","href":null}],"color":"default"}},{"object":"block","id":"1f6027e1-c95a-4be0-bc51-5c5ce1b37fa4","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:55:00.000Z","last_edited_time":"2022-10-27T06:56:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"ProxyObject","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ProxyObject","href":null}],"color":"default"}},{"object":"block","id":"f008ece2-aef8-4a40-a510-6fc15e856cca","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:56:00.000Z","last_edited_time":"2022-10-27T06:57:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"依存グラフの自動生成","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"依存グラフの自動生成","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"5b04efa5-4102-4a2e-b692-3f831897422f","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:56:00.000Z","last_edited_time":"2022-10-27T06:59:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"先程の例で、「lastName→name→hello」や、「age→hello」といった更新順を表すグラフがありました。値の依存関係によって更新順を決めたグラフです。この依存グラフを自動生成できれば、Computedは実現できそうです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"先程の例で、「lastName→name→hello」や、「age→hello」といった更新順を表すグラフがありました。値の依存関係によって更新順を決めたグラフです。この依存グラフを自動生成できれば、Computedは実現できそうです。","href":null}],"color":"default"}},{"object":"block","id":"42661045-7678-4cd1-a8e0-a0078e465e5a","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:59:00.000Z","last_edited_time":"2022-10-27T08:22:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"依存グラフの生成は、helloが呼ばれたときに行われています。値の中で他の値が使われるときに、使われる様子を追跡して、依存グラフを構築します","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"依存グラフの生成は、helloが呼ばれたときに行われています。値の中で他の値が使われるときに、使われる様子を追跡して、依存グラフを構築します","href":null}],"color":"default"}},{"object":"block","id":"f1bbf6c1-2f66-4ad7-baa2-3ec601d97275","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T08:22:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"this.deps","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this.deps","href":null},{"type":"text","text":{"content":" が依存元を表します。 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が依存元を表します。 ","href":null},{"type":"text","text":{"content":"self.currentDeps","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"self.currentDeps","href":null},{"type":"text","text":{"content":" が呼び出し元のリストです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が呼び出し元のリストです。","href":null}],"color":"default"}},{"object":"block","id":"71893f9a-b5c6-4f40-b852-524522f5866a","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T07:25:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"class DataValue {\n  get(self) {\n    if (self.currentDeps.length \u003e 0) {\n      // 最後の呼び出し元を依存先として追加する。\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n  \treturn this.value;\n}\nclass ComputedValue {\n  get(self) {\n  \tif (self.currentDeps.length \u003e 0) {\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n    self.currentDeps.push(this);\n  \tif (this.cache === undefined) {\n    \tthis.cache = this.computed(self);\n    }\n    self.currentDeps.pop()\n    return this.cache;\n  }\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"class DataValue {\n  get(self) {\n    if (self.currentDeps.length \u003e 0) {\n      // 最後の呼び出し元を依存先として追加する。\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n  \treturn this.value;\n}\nclass ComputedValue {\n  get(self) {\n  \tif (self.currentDeps.length \u003e 0) {\n    \tthis.deps.add(self.currentDeps.slice(-1)[0]);\n    }\n    self.currentDeps.push(this);\n  \tif (this.cache === undefined) {\n    \tthis.cache = this.computed(self);\n    }\n    self.currentDeps.pop()\n    return this.cache;\n  }\n}","href":null}],"language":"javascript"}},{"object":"block","id":"590b8d0e-d5eb-403a-b885-51e3b2f2a567","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T07:00:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"値が更新されるたびに、作られた依存グラフに従ってComputedを再計算します。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"値が更新されるたびに、作られた依存グラフに従ってComputedを再計算します。","href":null}],"color":"default"}},{"object":"block","id":"23316f3a-2d35-4197-a9e7-85aa8fffaf7a","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T08:07:00.000Z","last_edited_time":"2022-10-27T22:14:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"class DataValue {\n  set(self, value){\n  \tthis.value = value;\n    // モデルが更新されたときに、\n    this.update(self);\n  }\n  update(self) {\n    // 依存元を再計算する。\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}\nclass ComputedValue {\n  update(self) {\n  \tthis.cache = this.computed(self);\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"class DataValue {\n  set(self, value){\n  \tthis.value = value;\n    // モデルが更新されたときに、\n    this.update(self);\n  }\n  update(self) {\n    // 依存元を再計算する。\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}\nclass ComputedValue {\n  update(self) {\n  \tthis.cache = this.computed(self);\n    this.deps.forEach(dep=\u003edep.update(self));\n  }\n}","href":null}],"language":"javascript"}},{"object":"block","id":"b2e77aa2-0211-41e9-b286-bba4a14d6685","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T07:00:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"では、単なる関数の、どこに依存グラフを作るトリックが仕込まれているのでしょうか。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"では、単なる関数の、どこに依存グラフを作るトリックが仕込まれているのでしょうか。","href":null}],"color":"default"}},{"object":"block","id":"4d5f1e74-1794-4be4-8fae-7c48efef58b8","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:57:00.000Z","last_edited_time":"2022-10-27T06:57:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"heading_3","heading_3":{"rich_text":[{"type":"text","text":{"content":"ProxyObject","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ProxyObject","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"02d40729-a9e6-411d-886b-cd18d54ce4f3","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T06:57:00.000Z","last_edited_time":"2022-10-27T08:47:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"JavaScriptにはProxyObjectという機能があります。Objectとして振る舞う値が、プロパティーの読み書きをフックして良からぬことをするためのAPIです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"JavaScriptにはProxyObjectという機能があります。Objectとして振る舞う値が、プロパティーの読み書きをフックして良からぬことをするためのAPIです。","href":null}],"color":"default"}},{"object":"block","id":"842b75c8-df18-49c1-a166-f5eafbed4fc1","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T07:00:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ProxyObjectによって、self.dataやself.computedはただのObjectではなくなっています。プロパティーが使われるたびに、プロパティーが誰によって使われたかを記録することで、依存グラフを構築します。のちに、this.dataのプロパティーが書き換えられると、ProxyObjectがComputedを最計算します。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ProxyObjectによって、self.dataやself.computedはただのObjectではなくなっています。プロパティーが使われるたびに、プロパティーが誰によって使われたかを記録することで、依存グラフを構築します。のちに、this.dataのプロパティーが書き換えられると、ProxyObjectがComputedを最計算します。","href":null}],"color":"default"}},{"object":"block","id":"bbba96fa-7164-4515-867a-753517a4a0bf","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T08:08:00.000Z","last_edited_time":"2022-10-27T22:15:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"this.row_data = Object.entries(data).reduce(\n\t(o, [k, v]) =\u003e {return {[k]: new DataValue(v), ...o}}, {});\nthis.data = new Proxy(this.row_data, {\n\tget(t, prop) {\n  \treturn t[prop].get(self);\n  },\n  set(t, prop, value) {\n  \tt[prop].set(self, value);\n    return true;\n  }\n});","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"this.row_data = Object.entries(data).reduce(\n\t(o, [k, v]) =\u003e {return {[k]: new DataValue(v), ...o}}, {});\nthis.data = new Proxy(this.row_data, {\n\tget(t, prop) {\n  \treturn t[prop].get(self);\n  },\n  set(t, prop, value) {\n  \tt[prop].set(self, value);\n    return true;\n  }\n});","href":null}],"language":"javascript"}},{"object":"block","id":"ae26db48-1857-4e2f-8e61-5f4b6307ff54","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T22:15:00.000Z","last_edited_time":"2022-10-27T22:17:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ProxyObjectを使うことで、Modelを普通のObjectのように振る舞えるようになりました。素直にComputedを実装するだけで、依存グラフが得られる面白い仕掛けだと思います。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ProxyObjectを使うことで、Modelを普通のObjectのように振る舞えるようになりました。素直にComputedを実装するだけで、依存グラフが得られる面白い仕掛けだと思います。","href":null}],"color":"default"}},{"object":"block","id":"56428bc9-d859-4b12-a499-b10bce04fecb","parent":{"type":"page_id","page_id":"5d9d1a5b-f3ba-4562-a71d-126d16803f1c"},"created_time":"2022-10-27T22:16:00.000Z","last_edited_time":"2022-10-27T22:16:00.000Z","created_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"last_edited_by":{"object":"user","id":"7efc331f-9b9e-449d-862e-b0eebef23f04"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[],"color":"default"}}]}},"lastUpdated":"2022-10-27T22:17:00.000Z"},{"notionID":"5b75289d-a98f-4a25-a02b-4290f87cc16b","id":"2022-10-05-tictactoe-random","icon":"⭕","tags":["game"],"title":"三目並べをランダムに指したときの先手の勝利確率は?","summary":"まったくもってランダムに三目並べを行う","recordMap":null,"lastUpdated":"2022-10-05T10:39:00.000Z"},{"notionID":"b34f2185-860f-46e4-adae-b6a824a7c06b","id":"2022-08-07-ray-tracing-in-one-weekend","icon":"🔆","tags":["rust"],"title":"『Ray Tracing in One Weekend』をやった","summary":"レイトレーシングを実装する","recordMap":null,"lastUpdated":"2022-08-09T11:35:00.000Z"},{"notionID":"9137f946-c9f2-495a-9465-e22c317717bf","id":"2022-08-09-infinite-turtle-brainfuck","icon":"🧠","tags":["game"],"title":"コンベアで計算する『Infinite Turtle』でBrainfuckインタプリタを実装した","summary":"ベルトコンベアでbrainfuckを計算する様子","recordMap":null,"lastUpdated":"2022-08-09T11:32:00.000Z"},{"notionID":"7b60f0a0-848e-40d5-be90-9f28d934fbb2","id":"2022-10-25-rust-c-compiler","icon":"🦀","tags":["rust","compiler"],"title":"Rustで「低レイヤを知りたい人のためのCコンパイラ作成入門」を少しやる","summary":"コンパイラ作りを思い出す","recordMap":null,"lastUpdated":"2022-10-25T09:06:00.000Z"},{"notionID":"02f7fec3-88ee-4275-bb46-057a81153eba","id":"2022-07-24-isucon12-qualified","icon":"🎉","tags":["isucon","web"],"title":"ISUCON12予選突破した。 :old_noto_innocent: ","summary":"ISUCON12予選突破できた。そのまとめ。","recordMap":null,"lastUpdated":"2022-07-28T02:00:00.000Z"},{"notionID":"8837459a-5a44-48f1-ba64-3764c7cd659b","id":"2022-08-08-inifinite-turtles","icon":"🐢","tags":["game"],"title":"自動化コンベアでチューリング完全を目指す『Infinite Turtles』の紹介","summary":"steamのゲームの紹介。ベルトコンベアでいろんな問題を解く。","recordMap":null,"lastUpdated":"2022-08-09T08:45:00.000Z"},{"notionID":"31901beb-64fe-4576-8211-e14654a1c0c7","id":"2022-07-13-notion-blog","icon":"📝","tags":["notion","nextjs"],"title":"Notionでもブログを書けるように","summary":"Notionからnextjsでブログを生成する","recordMap":null,"lastUpdated":"2022-08-09T04:45:00.000Z"}]},"__N_SSG":true},"page":"/[id]","query":{"id":"2022-10-28-vue-computed"},"buildId":"nq8v7rD2CePEjF_itLjZ-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>